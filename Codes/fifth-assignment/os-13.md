# 操作系统第十三章作业
## 1.程序直接控制方式 
计算机从外部设备读取数据到存储器，每次读一个字的数据。对读入的每个字，CPU需要对外设状态进行**循环检查（忙/等）**，直到确定该字已经在I/O控制器的数据寄存器中。由于CPU的高速性和I/O设备的低速性，致使CPU的绝大部分时间都处于等待I/O设备完成数据I/O的循环测试中，造成了 CPU资源的极大浪费。

+ **优点**：简单易于实现
+ **缺点**：由于CPU和I/O设备只能串行工作，导致CPU的利用率相当低。

## 2.中断驱动方式
**中断驱动方式**的思想是，**允许I/O设备主动打断CPU的运行并请求服务**，从而“解放”CPU，使得其向I/O控制器发送读命令后可以继续做其他有用的工作，CPU与I/O可以并行操作。

从**I/O控制器的角度**来看，I/O控制器从CPU接收一个读命令，然后从外围设备读数据。一旦数据读入到该I/O控制器的数据寄存器，便通过控制线给CPU发出一个中断信号，表示数据已准备好，然后等待CPU请求该数据。I/O控制器收到CPU发出的取数据请求后，将数据放到数据总线上，传到CPU的寄存器中。至此，本次I/O操作完成，I/O控制器又可幵始下一次I/O操作。

从**CPU的角度**来看，CPU发出读命令，然后保存当前运行程序的上下文（现场，包括程序计数器及处理机寄存器），转去执行其他程序。在每个指令周期的末尾，CPU检查中断。当有来自I/O控制器的中断时，CPU保存当前正在运行程序的上下文，转去执行中断处理程序处理该中断。这时，CPU从I/O控制器读一个字的数据传送到寄存器，并存入主存。接着， CPU恢复发出I/O命令的程序（或其他程序）的上下文，然后继续运行。

+ **优点**：中断驱动方式比程序直接控制方式有效。
+ **缺点**：由于数据中的每个字在存储器与I/O控制器之间的传输都必须经过CPU，这就导致了中断驱动方式仍然会消耗较多的CPU时间。

## 3. DMA方式

**DMA（直接存储器存取）** 方式的基本思想是**在I/O设备和内存之间开辟直接的数据交换通路**，彻底“解放” CPU。DMA方式的特点是：
+ 基本单位是**数据块**。
+ 所传送的数据，是**从设备直接送入内存**的，或者相反。
+ 仅在传送一个或多个数据块的**开始和结束**时，**才需CPU干预**，整块**数据的传送是在 DMA控制器的控制下完成**的。

为了实现在主机与控制器之间成块数据的直接交换，必须在DMA控制器中设置如下**四类寄存器**：

+ 命令/状态寄存器(CR)：用于接收从CPU发来的I/O命令或有关控制信息，或设备的状态。
+ 内存地址寄存器(MAR)：在输入时，它存放把数据从设备传送到内存的起始目标地址；在输出时，它存放由内存到设备的内存源地址。
+ 数据寄存器(DR)：用于暂存从设备到内存，或从内存到设备的数据。
+ 数据计数器(DC)：存放本次CPU要读或写的字（节）数。

DMA控制方式与中断驱动方式的主要区别是中断驱动方式在每个数据需要传输时中断CPU，而DMA控制方式则是在所要求传送的一批数据全部传送结束时才中断CPU；此外，中断驱动方式数据传送是在中断处理时由CPU控制完成的，而DMA控制方式则是在DMA 控制器的控制下完成的。

+ **优点**：可以提高数据传输效率，实现高速数据传输
+ **缺点**：
    1）复杂性：DMA传送方式需要专门的硬件支持，包括DMA控制器、DMA通道、DMA缓冲区等，需要进行复杂的硬件和软件设计和实现。

    2）容错性：由于DMA传送方式不经过CPU的中介，一旦出现数据传输错误，CPU无法及时响应和处理，因此需要额外的容错机制来保证数据传输的可靠性。

    3）独占性：DMA传送方式需要占用一定的系统资源，可能会导致其他任务无法及时执行，从而影响系统的整体性能。

## 4.通道控制方式
**I/O通道是指专门负责输入/输出的处理机**。I/O通道方式是DMA方式的发展，它可以进一步减少CPU的干预，即把对一个数据块的读（或写）为单位的干预，减少为对一组数据块的读（或写）及有关的控制和管理为单位的干预。同时，又可以实现CPU、通道和I/O设备三者的并行操作，从而更有效地提高整个系统的资源利用率。

当CPU要完成一组相关的读（或写）操作及有关控制时，只需**向I/O通道发送一条I/O指令**，以给出其所要执行的通道程序的首地址和要访问的I/O设备，通道接到该指令后，通过**执行通道程序**便可完成CPU指定的I/O任务，**数据传送结束时向CPU发中断请求**。I/O通道与一般处理机的区别是：通道指令的类型单一，没有自己的内存，通道所执行的**通道程序是放在主机的内存中**的，也就是说**通道与CPU共享内存**。

+ **优点**：通道控制进一步减轻了CPU的工作负担，增加了计算机系统的并行工作程度。把CPU从繁琐的输入/输出操作中解放出来。采用通道技术后，不仅能实现CPU和通道的并行操作，而且通道与通道之间也能实现并行操作，各通道上的外设也能实现并行操作，从而可提高整个系统的效率。

+ **缺点**：由于需要更多硬件（通道处理器），因此其成本较高。通道控制方式通常应用于大型数据交互的场合。